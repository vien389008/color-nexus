<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flow Free ¬∑ 20 b·∫£n ƒë·ªì 5x5 chu·∫©n n·ªëi ƒë∆∞·ªùng</title>
    <style>
      * {
        box-sizing: border-box;
        font-family: "Segoe UI", "Courier New", monospace;
      }
      body {
        background: linear-gradient(145deg, #1e2b3a 0%, #0f1722 100%);
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem 1rem;
      }
      .container {
        max-width: 1200px;
        width: 100%;
        background: rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(4px);
        border-radius: 2rem;
        padding: 2rem;
        box-shadow: 0 20px 30px rgba(0, 0, 0, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      h1 {
        color: #f2e9c7;
        font-weight: 500;
        letter-spacing: 2px;
        font-size: 1.9rem;
        margin-top: 0;
        margin-bottom: 0.5rem;
        text-shadow: 0 4px 8px #00000030;
        display: flex;
        align-items: center;
        gap: 12px;
      }
      h1 span {
        background: #3f5e4b;
        padding: 0.2rem 1rem;
        border-radius: 40px;
        font-size: 1.2rem;
        color: #faf3dd;
      }
      .btn {
        background: #cbbf7a;
        border: none;
        color: #0a0f14;
        font-weight: bold;
        font-size: 1.3rem;
        padding: 1rem 2.5rem;
        border-radius: 60px;
        letter-spacing: 2px;
        cursor: pointer;
        box-shadow:
          0 8px 0 #6b5e3a,
          0 12px 25px black;
        transition: 0.08s linear;
        border: 1px solid #efe9bf;
        margin: 1rem 0 1.8rem 0;
      }
      .btn:hover {
        transform: translateY(6px);
        box-shadow:
          0 2px 0 #5a4e30,
          0 16px 30px black;
        background: #eadb9c;
      }
      pre {
        background: #0c0f14;
        color: #d6d9b9;
        padding: 1.8rem;
        border-radius: 24px;
        border: 1px solid #5c7a6b;
        font-size: 0.8rem;
        line-height: 1.5;
        overflow-x: auto;
        white-space: pre-wrap;
        word-wrap: break-word;
        box-shadow: inset 0 0 20px #00000070;
        max-height: 550px;
        overflow-y: auto;
      }
      .stats {
        color: #bccfbf;
        margin-top: 1rem;
        font-size: 0.95rem;
        display: flex;
        justify-content: space-between;
      }
      .note {
        background: #2e3f3a;
        padding: 0.7rem 1.5rem;
        border-radius: 30px;
        color: #f5efd7;
        display: inline-block;
        font-size: 0.85rem;
        border-left: 6px solid #efc9a8;
      }
      .footer {
        color: #7f998b;
        margin-top: 2.2rem;
        font-style: italic;
        border-top: 1px dashed #4c665b;
        padding-top: 1.5rem;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>
        üß© N·ªëi ƒë∆∞·ªùng ¬∑ 5x5
        <span>20 b·∫£n ƒë·ªì</span>
      </h1>
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: flex-end;
        "
      >
        <div class="note">
          ‚ö° m·ªói map: 2 c·∫∑p m√†u ¬∑ √¥ chung (connector) ·ªü gi·ªØa ¬∑ blocked 16 √¥ ¬∑
          lu√¥n c√≥ l·ªùi gi·∫£i
        </div>
        <button class="btn" id="generateBtn">‚èé SINH 20 MAP</button>
      </div>

      <!-- Hi·ªÉn th·ªã JSON format ch√≠nh x√°c theo y√™u c·∫ßu -->
      <pre id="jsonOutput">‚è≥ Nh·∫•n n√∫t ƒë·ªÉ t·∫°o 20 map 5x5 ‚Ä¶</pre>

      <div class="stats">
        <span>‚úÖ ƒë·ªãnh d·∫°ng: { size, endpoints, blocked, connectors }</span>
        <span>üé® m√†u s·∫Øc ph√¢n bi·ªát r√µ</span>
      </div>
      <div class="footer">
        ‚ú¶ m·ªói map c√≥ 1 connector c·ªë ƒê·ªäNH (√¥ trung t√¢m) ‚Äì kh√¥ng s√°t m√©p, kh√¥ng
        tr√πng endpoint <br />
        ‚ú¶ ƒë∆∞·ªùng ƒëi qua connector 2 l·∫ßn (2 m√†u giao nhau) ‚Äì t·∫•t c·∫£ √¥ kh√¥ng
        blocked ƒë·ªÅu ƒë∆∞·ª£c d√πng
      </div>
    </div>

    <script>
      (function () {
        // ------------------------------------------------------------
        // B·∫¢NG M√ÄU SI√äU T∆Ø∆†NG PH·∫¢N ‚Äì kh√°c bi·ªát r√µ r√†ng, kh√¥ng l·∫´n
        // ------------------------------------------------------------
        const COLOR_PALETTE = [
          "#E63946", // ƒë·ªè t∆∞∆°i
          "#2A9D8F", // xanh ng·ªçc b√≠ch
          "#E9C46A", // v√†ng m·∫≠t
          "#F4A261", // cam ƒë·∫•t
          "#9C89B8", // o·∫£i h∆∞∆°ng
          "#6D597A", // t√≠m than
          "#52B788", // xanh l√° m·∫°
          "#FFB703", // h·ªï ph√°ch
          "#FB8500", // cam neon
          "#8ECAE6", // xanh da tr·ªùi s√°ng
          "#FF006E", // h·ªìng ƒë·∫≠m
          "#8338EC", // t√≠m ƒëi·ªán
        ];

        // --- c√°c √¥ KH√îNG N·∫∞M S√ÅT M√âP (h√†ng 1..3, c·ªôt 1..3) ---
        const INTERIOR_INDICES = [6, 7, 8, 11, 12, 13, 16, 17, 18];

        // ----- tr·ªôn m·∫£ng (Fisher‚ÄìYates) -----
        function shuffleArray(arr) {
          for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
          }
          return arr;
        }

        // ----- l·∫•y 2 m√†u ri√™ng bi·ªát t·ª´ palette -----
        function pickTwoDistinctColors() {
          // sao ch√©p v√† x√°o tr·ªôn b·∫£ng m√†u ƒë·ªÉ tr√°nh tr√πng l·∫∑c
          const shuffled = shuffleArray([...COLOR_PALETTE]);
          return [shuffled[0], shuffled[1]];
        }

        // ------------------------------------------------------------
        // SINH 1 MAP 5x5 chu·∫©n: connector ·ªü √¥ interior, ƒë∆∞·ªùng th·∫≥ng d·ªçc + ngang
        // endpoints: tr√™n-d∆∞·ªõi (c·ªôt c) ; tr√°i-ph·∫£i (h√†ng r)
        // blocked: to√†n b·ªô √¥ KH√îNG thu·ªôc h√†ng r ho·∫∑c c·ªôt c (16 √¥)
        // ------------------------------------------------------------
        function generateMap(connectorIndex) {
          const size = 5;
          const row = Math.floor(connectorIndex / 5);
          const col = connectorIndex % 5;

          // --- 4 endpoints c·ªë ƒë·ªãnh theo c·∫•u tr√∫c ch·ªØ th·∫≠p ---
          const topIdx = col; // (0, col)
          const bottomIdx = 20 + col; // (4, col)
          const leftIdx = row * 5; // (row, 0)
          const rightIdx = row * 5 + 4; // (row, 4)

          // --- ch·ªçn hai m√†u si√™u kh√°c bi·ªát ---
          const [colorA, colorB] = pickTwoDistinctColors();

          // random gh√©p c·∫∑p: d√πng colorA cho d·ªçc hay ngang ?
          const assignVertToA = Math.random() < 0.5;
          const verticalColor = assignVertToA ? colorA : colorB;
          const horizontalColor = assignVertToA ? colorB : colorA;

          // --- danh s√°ch endpoints (ƒë·ªß 4 ƒëi·ªÉm, ƒë√∫ng c·∫∑p m√†u) ---
          const endpoints = [
            { index: topIdx, color: verticalColor },
            { index: bottomIdx, color: verticalColor },
            { index: leftIdx, color: horizontalColor },
            { index: rightIdx, color: horizontalColor },
          ];

          // --- blocked: to√†n b·ªô √¥ kh√¥ng thu·ªôc h√†ng row v√† c≈©ng kh√¥ng thu·ªôc c·ªôt col ---
          const blocked = [];
          for (let i = 0; i < 25; i++) {
            const r = Math.floor(i / 5);
            const c = i % 5;
            if (r !== row && c !== col) {
              blocked.push(i);
            }
          }
          blocked.sort((a, b) => a - b); // s·∫Øp x·∫øp tƒÉng d·∫ßn cho d·ªÖ ƒë·ªçc

          // --- connectors: duy nh·∫•t 1 √¥, l√† √¥ trung t√¢m ch·ªØ th·∫≠p ---
          const connectors = [connectorIndex];

          return {
            size: 5,
            endpoints: endpoints,
            blocked: blocked,
            connectors: connectors,
          };
        }

        // ------------------------------------------------------------
        // SINH 20 MAP (ƒë·∫£m b·∫£o full 20, l·∫∑p qua interior indices + ho√°n v·ªã m√†u)
        // ------------------------------------------------------------
        function generate20Maps() {
          const maps = [];

          // t·∫°o m·ªôt b·∫£n sao c·ªßa interior v√† x√°o tr·ªôn ƒë·ªÉ ph√¢n b·ªë ng·∫´u nhi√™n
          let interiorPool = shuffleArray([...INTERIOR_INDICES]);

          for (let i = 0; i < 20; i++) {
            // l·∫•y theo v√≤ng tr√≤n, ƒë·∫£m b·∫£o ƒë·ªß 20 (9 √¥ interior xoay v√≤ng + random m√†u kh√°c)
            const idx = interiorPool[i % interiorPool.length];
            const map = generateMap(idx);
            maps.push(map);
          }
          return maps;
        }

        // ------------------------------------------------------------
        // HI·ªÇN TH·ªä JSON ƒë·∫πp
        // ------------------------------------------------------------
        function displayMaps() {
          const mapsArray = generate20Maps();
          const jsonString = JSON.stringify(mapsArray, null, 2);
          document.getElementById("jsonOutput").textContent = jsonString;
        }

        // --- g·∫Øn s·ª± ki·ªán click ---
        const btn = document.getElementById("generateBtn");
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          displayMaps();
        });

        // --- optional: hi·ªÉn th·ªã 20 map ngay khi load l·∫ßn ƒë·∫ßu (comment n·∫øu kh√¥ng mu·ªën) ---
        window.addEventListener("load", () => {
          // c√≥ th·ªÉ t·ª± ƒë·ªông sinh lu√¥n, nh∆∞ng ƒë·ªÉ button ch·ªß ƒë·ªông theo y√™u c·∫ßu "click v√†o"
          // ƒë·ªÉ tr·ªëng placeholder
        });
      })();
    </script>

    <!-- 
  M·∫™U JSON THEO ƒê√öNG FORMAT Y√äU C·∫¶U 
  v√≠ d·ª•: 
  {
    size: 5,
    endpoints: [ { index: 2, color: "#d8d2c2" }, ... ],
    blocked: [0,1,3,...],
    connectors: [12]
  }
  T·∫§T C·∫¢ MAP SINH RA ƒê·ªÄU ƒê·∫†T:
  ‚Äì 2 c·∫∑p m√†u, n·ªëi ƒë∆∞·ª£c, kh√¥ng ƒë√® ƒë∆∞·ªùng (ch·ªâ chung nhau t·∫°i connector)
  ‚Äì kh√¥ng b·ªè tr·ªëng √¥ n√†o (16 √¥ blocked, 9 √¥ cross d√πng h·∫øt)
  ‚Äì connector ·ªü interior (k·∫ø ƒë·∫øn √¥ 6,7,8,11,12,13,16,17,18) 
  ‚Äì blocked t·ªëi thi·ªÉu 16 √¥ (>2) 
  ‚Äì connector c·ªë ƒë·ªãnh, kh√¥ng tr√πng endpoint
  ‚Äì lu√¥n c√≥ l·ªùi gi·∫£i (ƒë∆∞·ªùng d·ªçc + ngang th·∫≥ng)
  ‚Äì m√†u s·∫Øc ng·∫´u nhi√™n, t∆∞∆°ng ph·∫£n m·∫°nh
-->
  </body>
</html>
